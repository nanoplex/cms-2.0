(function(){"use strict";var n=document.getElementById("page"),i,u,r;n.ready=function(){n.changeView("view-loading")};n.handleAuth=function(t){t=t.detail.response;n.changeView("view-loading");t==="True"?n.$.ajaxSite.go():t==="False"&&n.changeView("view-login")};n.handleLogin=function(t){t=t.detail.response;t==="true"?(n.email=null,n.password=null,n.$.ajaxAuth.go()):i.innerHTML=t};n.handleSite=function(t){t=t.detail.response;document.querySelector("header").removeAttribute("hidden");document.getElementById("add").removeAttribute("hidden");t!==null&&(n.Site=n.formatComponents(t),n.LastPage!==undefined&&n.LastPage.match(/^view-/)===null?n.changeView(n.LastPage):(n.Site.Pages.length>0?n.changeView(n.Site.Pages[0].Name):n.changeView("view-add-page"),n.LastPage=n.Site.Pages[0].Name),console.log("site",n.Site))};n.formatComponents=function(n){for(var r,u,f,t,s=n.Pages,i={},e=[],o=0;o<s.length;o++){if(r=s[o],r.Components!==null)for(u=0;u<r.Components.length;u++){for(f=r.Components[u],t=0;t<n.Components.length;t++)n.Components[t].Name==f._t&&(i=JSON.parse(JSON.stringify(n.Components[t])));for(t=0;t<i.Props.length;t++)i.Props[t].Value=f[i.Props[t].Name];e[e.length]={_id:f._id,Name:i.Name,Props:i.Props}}r.Components=e}return n};n.stringify=function(n){return JSON.stringify(n)};n.isObject=function(n){return typeof n=="object"?!0:!1};n.isList=function(n){return n.match(/^List/)!==null?!0:!1};n.login=function(){var t=document.querySelectorAll("section[data-pagename=view-login] input");i=document.querySelector("section[data-pagename=view-login] .status");n.validateInputs(t)?(n.injectBoundHTML("<paper-spinner active><paper-spinner/>",i),n.$.ajaxLogin.go()):i.innerHTML=""};n.validateInputs=function(t){for(var i=0;i<t.length;i++)if(t[i]!==null&&!t[i].validity.valid)return n.focusInputs(t),!1;return!0};n.focusInputs=function(n){for(var t=0;t<n.length;t++)if(!n[t].validity.valid){n[t].focus();break}};n.changeView=function(t){n.LastPage=n.SelectedPage;n.SelectedPage=t;n.setTitle()};n.getComponentByType=function(t){for(var i=0;i<n.Site.Components.length;i++)if(n.Site.Components[i].Name===t)return n.Site.Components[i];return null};n.setTitle=function(){var t=document.querySelector("title");n.injectBoundHTML(n.SelectedPage.replace(/^view-/,"").replace(/-/g," ")+" - Admin",t)};n.home=function(){n.changeView(n.LastPage)};u=!0;n.status=function(t,i){var r=document.getElementById("status"),e=r.querySelector("p"),f=r.querySelector("button");n.home();e.innerHTML=t;i!==undefined?f.onclick=function(){u=!1;r.setAttribute("hidden","")}:f.setAttribute("hidden","");r.removeAttribute("class");setTimeout(function(){u&&(i(),r.setAttribute("hidden",""))},5e3)};var f=!1,e=!1,s=!1,t,o;n.startPageSelect=function(n){f=!1;e=!1;document.querySelector("core-drawer-panel").setAttribute("disableSwipe","true");setTimeout(function(){if(!f){var i=document.querySelector("nav section[data-id='"+n+"']");t=undefined;e=!0;i.setAttribute("class","drag");window.onmousemove=function(n){t==undefined&&(t=n.clientY);o=n.clientY;i.setAttribute("style","top:"+(o-t)+"px")}}},500)};n.endPageSelect=function(i,r,u){if(e){window.onmousemove=undefined;var h=o-t,c=document.querySelectorAll("nav section[data-id]")[0].offsetHeight,s=Math.round(u+h/-c);s=s>u?s+1:s-1;n.$.ajaxEditPage.params='{"id":"'+i+'","name":"'+r+'","order":'+s+"}";n.$.ajaxEditPage.go()}else n.changeView(r),f=!0;document.querySelector("core-drawer-panel").setAttribute("disableSwipe","false")};n.deletePage=function(t){n.$.ajaxDeletePage.params='{"id":"'+t+'"}';n.$.ajaxDeletePage.go();s=!1};n.addPage=function(){var t=document.querySelector("nav section:nth-child(4)"),i;t===null&&(t=document.querySelector("nav section:nth-child(3)"));i=t!=null?parseInt(t.getAttribute("data-order"),10)+1:0;n.$.ajaxAddPage.params='{"name":"'+n.newPageName+'","order":'+i+"}";n.status("page added",function(){n.$.ajaxAddPage.go()});n.LastPage=undefined;n.newPageName=null};n.toggleNav=function(){document.querySelector("core-drawer-panel").togglePanel()};n.toggleAddOptions=function(){n.$.addOptions.getAttribute("hidden")==null?n.$.addOptions.setAttribute("hidden",""):(n.$.addOptions.removeAttribute("hidden"),n.$.addComponentOptions.setAttribute("hidden",""))};n.showAddPage=function(){n.changeView("view-add-page")};r=!1;n.showEditComponent=function(t,i,u){if(r){var e=JSON.parse(u.getAttribute("data")),f=new ElComponent;f._id=e._id;f.Name=e.Name;f.Props=e.Props;n.$.viewComponent.innerHTML="";n.$.viewComponent.appendChild(f);n.changeView("view-component")}else r=!0,setTimeout(function(){r=!1},300)};n.showAddComponentOptions=function(){n.$.addOptions.setAttribute("hidden","");n.$.addComponentOptions.removeAttribute("hidden")};n.showAddComponent=function(t){var r=new ElComponent,i;i=n.getComponentByType(t.currentTarget.innerText);i!==null&&(r.Name=i.Name,r.Props=i.Props,n.$.viewComponent.innerHTML="",n.$.viewComponent.appendChild(r),n.changeView("view-component"),n.$.addComponentOptions.setAttribute("hidden",""))}})();
//# sourceMappingURL=admin.min.js.map
